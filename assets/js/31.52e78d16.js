(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{526:function(v,_,e){"use strict";e.r(_);var t=e(6),o=Object(t.a)({},(function(){var v=this,_=v.$createElement,e=v._self._c||_;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("blockquote",[e("p",[e("code",[v._v("HTTP")]),v._v(" 使用了请求 - 应答模式，客户端主动发起请求，服务器被动回复请求；")]),v._v(" "),e("p",[e("code",[v._v("HTTP")]),v._v(" 是灵活可扩展的，可以任意添加头字段实现任意功能；")]),v._v(" "),e("p",[e("code",[v._v("HTTP")]),v._v(" 本质上是无状态的，每个请求都是互相独立、毫无关联的，协议不要求客户端或服务器记录\t\t请求相关的信息")])]),v._v(" "),e("p",[e("strong",[v._v("HTTP 协议的请求报文和响应报文的结构基本相同，由三大部分组成")])]),v._v(" "),e("p",[e("strong",[v._v("request:")])]),v._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5Cnice%5CDesktop%5C%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%5C%E7%A7%8B%E6%8B%9B%E5%87%86%E5%A4%87%5Cimgs%5C10.png",alt:"10"}})]),v._v(" "),e("p",[e("strong",[v._v("response:")])]),v._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5Cnice%5CDesktop%5C%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%5C%E7%A7%8B%E6%8B%9B%E5%87%86%E5%A4%87%5Cimgs%5C11.png",alt:"11"}})]),v._v(" "),e("p",[e("strong",[v._v("请求方法：")])]),v._v(" "),e("ul",[e("li",[e("code",[v._v("GET")]),v._v("：获取资源，可以理解为读取或者下载数据；")]),v._v(" "),e("li",[e("code",[v._v("HEAD")]),v._v("：获取资源的元信息；")]),v._v(" "),e("li",[e("code",[v._v("POST")]),v._v("：向资源提交数据，相当于写入或上传数据；")]),v._v(" "),e("li",[e("code",[v._v("PUT")]),v._v("：类似 "),e("code",[v._v("POST")]),v._v("；")]),v._v(" "),e("li",[e("code",[v._v("DELETE")]),v._v("：删除资源；")]),v._v(" "),e("li",[e("code",[v._v("CONNECT")]),v._v("：建立特殊的连接隧道；")]),v._v(" "),e("li",[e("code",[v._v("OPTIONS")]),v._v("：列出可对资源实行的方法；")]),v._v(" "),e("li",[e("code",[v._v("TRACE")]),v._v("：追踪请求 - 响应的传输路径")])]),v._v(" "),e("p",[e("strong",[v._v("状态码：")]),v._v(" "),e("a",{attrs:{href:"https://tool.oschina.net/commons?type=5",target:"_blank",rel:"noopener noreferrer"}},[v._v("状态码"),e("OutboundLink")],1)]),v._v(" "),e("p",[v._v("(http://interview.poetries.top/fe-base-docs/http-protocol/base/12-HTTP的实体数据.html#数据类型与编码")]),v._v(" "),e("p",[e("strong",[v._v("数据类型与编码")])]),v._v(" "),e("blockquote",[e("p",[v._v("但仅有 "),e("code",[v._v("MIME type")]),v._v(" 还不够，因为 "),e("code",[v._v("HTTP")]),v._v(" 在传输时为了节约带宽，有时候还会压缩数据，为了不要让浏览器继续“猜”，还需要有一个“Encoding type”，告诉数据是用的什么编码格式，这样对方才能正确解压缩，还原出原始的数据。")])]),v._v(" "),e("ul",[e("li",[v._v("text：即文本格式的可读数据，我们最熟悉的应该就是 "),e("code",[v._v("text/html")]),v._v(" 了，表示超文本文档，此外还有纯文本 "),e("code",[v._v("text/plain")]),v._v("、样式表 "),e("code",[v._v("text/css")]),v._v(" 等。")]),v._v(" "),e("li",[e("code",[v._v("image")]),v._v("：即图像文件，有 "),e("code",[v._v("image/gif")]),v._v("、"),e("code",[v._v("image/jpeg")]),v._v("、"),e("code",[v._v("image/png")]),v._v(" 等。")]),v._v(" "),e("li",[e("code",[v._v("audio/video")]),v._v("：音频和视频数据，例如 "),e("code",[v._v("audio/mpeg")]),v._v("、"),e("code",[v._v("video/mp4")]),v._v(" 等。")]),v._v(" "),e("li",[e("code",[v._v("application")]),v._v("：数据格式不固定，可能是文本也可能是二进制，必须由上层应用程序来解释。常见的有 "),e("code",[v._v("application/json")]),v._v("，"),e("code",[v._v("application/javascript")]),v._v("、"),e("code",[v._v("application/pdf")]),v._v(" 等，另外，如果实在是不知道数据是什么类型，像刚才说的“黑盒”，就会是 "),e("code",[v._v("application/octet-stream")]),v._v("，即不透明的二进制数据")])]),v._v(" "),e("p",[e("strong",[v._v("比起 "),e("code",[v._v("MIME type")]),v._v(" 来说，"),e("code",[v._v("Encoding type")]),v._v(" 就少了很多，常用的只有下面三种")])]),v._v(" "),e("ul",[e("li",[e("code",[v._v("gzip")]),v._v("："),e("code",[v._v("GNU zip")]),v._v(" 压缩格式，也是互联网上最流行的压缩格式；")]),v._v(" "),e("li",[e("code",[v._v("deflate")]),v._v("："),e("code",[v._v("zlib")]),v._v("（"),e("code",[v._v("deflate")]),v._v("）压缩格式，流行程度仅次于 "),e("code",[v._v("gzip")]),v._v("；")]),v._v(" "),e("li",[e("code",[v._v("br")]),v._v("：一种专门为 "),e("code",[v._v("HTTP")]),v._v(" 优化的新压缩算法（"),e("code",[v._v("Brotli")]),v._v("）")])]),v._v(" "),e("p",[e("code",[v._v("HTTP")]),v._v(" 协议为此定义了两个 "),e("code",[v._v("Accept")]),v._v(" 请求头字段和两个 "),e("code",[v._v("Content")]),v._v(" 实体头字段，用于客户端和服务器进行“内容协商”。也就是说，客户端用 "),e("code",[v._v("Accept")]),v._v(" 头告诉服务器希望接收什么样的数据，而服务器用 "),e("code",[v._v("Content")]),v._v(" 头告诉客户端实际发送了什么样的数据")]),v._v(" "),e("p",[e("img",{attrs:{src:"http://poetries1.gitee.io/img-repo/2019/12/15.png",alt:"img"}})]),v._v(" "),e("p",[e("code",[v._v("Accept-Language")]),v._v("字段标记了客户端可理解的自然语言，也允许用“,”做分隔符列出多个类型")]),v._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[v._v("Accept"),e("span",{pre:!0,attrs:{class:"token operator"}},[v._v("-")]),v._v("Language"),e("span",{pre:!0,attrs:{class:"token operator"}},[v._v(":")]),v._v(" zh"),e("span",{pre:!0,attrs:{class:"token operator"}},[v._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[v._v("CN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(",")]),v._v(" zh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(",")]),v._v(" en\n")])]),v._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[v._v("1")]),e("br")])]),e("ul",[e("li",[v._v("数据类型表示实体数据的内容是什么，使用的是 "),e("code",[v._v("MIME type")]),v._v("，相关的头字段是 "),e("code",[v._v("Accept")]),v._v("和 "),e("code",[v._v("Content-Type")]),v._v("；")]),v._v(" "),e("li",[v._v("数据编码表示实体数据的压缩方式，相关的头字段是 "),e("code",[v._v("Accept-Encoding")]),v._v(" 和 "),e("code",[v._v("Content-Encoding")]),v._v("；")]),v._v(" "),e("li",[v._v("语言类型表示实体数据的自然语言，相关的头字段是 "),e("code",[v._v("Accept-Language")]),v._v(" 和 "),e("code",[v._v("Content-Language")]),v._v("；")]),v._v(" "),e("li",[v._v("字符集表示实体数据的编码方式，相关的头字段是 "),e("code",[v._v("Accept-Charset")]),v._v("和 Content-Type；")]),v._v(" "),e("li",[v._v("客户端需要在请求头里使用 "),e("code",[v._v("Accept")]),v._v(" 等头字段与服务器进行“内容协商”，要求服务器返回最合适的数据； "),e("code",[v._v("Accept")]),v._v(" 等头字段可以用“,”顺序列出多个可能的选项，还可以用“"),e("code",[v._v(";q=")]),v._v("”参数来精确指定权重")])]),v._v(" "),e("p",[e("strong",[v._v("传输大文件：")])]),v._v(" "),e("blockquote",[e("p",[v._v("要注意这四种方法不是互斥的，而是可以混合起来使用，例如压缩后再分块传输，或者分段后再分块")])]),v._v(" "),e("ul",[e("li",[v._v("压缩 HTML 等文本文件是传输大文件最基本的方法；")]),v._v(" "),e("li",[v._v("分块传输可以流式收发数据，节约内存和带宽，使用响应头字段“"),e("code",[v._v("Transfer-Encoding: chunked")]),v._v("”来表示，分块的格式是 16 进制长度头 + 数据块；")]),v._v(" "),e("li",[v._v("范围请求可以只获取部分数据，即“分块请求”，实现视频拖拽或者断点续传，使用请求头字段“"),e("code",[v._v("Range")]),v._v("”和响应头字段“"),e("code",[v._v("Content-Range")]),v._v("”，响应状态码必须是 206；")]),v._v(" "),e("li",[v._v("也可以一次请求多个范围，这时候响应报文的数据类型是“"),e("code",[v._v("multipart/byteranges")]),v._v("”，"),e("code",[v._v("body")]),v._v(" 里的多个部分会用 "),e("code",[v._v("boundary")]),v._v(" 字符串分隔")])]),v._v(" "),e("p",[e("strong",[v._v("连接管理：")])]),v._v(" "),e("ul",[e("li",[v._v("早期的 "),e("code",[v._v("HTTP")]),v._v(" 协议使用短连接，收到响应后就立即关闭连接，效率很低；")]),v._v(" "),e("li",[e("code",[v._v("HTTP/1.1")]),v._v(" 默认启用长连接，在一个连接上收发多个请求响应，提高了传输效率；")]),v._v(" "),e("li",[v._v("服务器会发送“"),e("code",[v._v("Connection: keep-alive")]),v._v("”字段表示启用了长连接；")]),v._v(" "),e("li",[v._v("报文头里如果有“"),e("code",[v._v("Connection: close")]),v._v("”就意味着长连接即将关闭；")]),v._v(" "),e("li",[v._v("过多的长连接会占用服务器资源，所以服务器会用一些策略有选择地关闭长连接；")]),v._v(" "),e("li",[v._v("“队头阻塞”问题会导致性能下降，可以用“并发连接”和“域名分片”技术缓解")])]),v._v(" "),e("p",[e("strong",[v._v("缓存：")])]),v._v(" "),e("ol",[e("li",[e("p",[v._v("服务器端缓存控制策略")]),v._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5Cnice%5CDesktop%5C%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%5C%E7%A7%8B%E6%8B%9B%E5%87%86%E5%A4%87%5Cimgs%5C35.png",alt:"35"}})])]),v._v(" "),e("li")]),v._v(" "),e("p",[e("img",{attrs:{src:"C:%5CUsers%5Cnice%5CDesktop%5C%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%5C%E7%A7%8B%E6%8B%9B%E5%87%86%E5%A4%87%5Cimgs%5C36.png",alt:"36"}})]),v._v(" "),e("h2",{attrs:{id:"http0-9"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http0-9"}},[v._v("#")]),v._v(" HTTP0.9")]),v._v(" "),e("ul",[e("li",[v._v("第一个是只有一个请求行，并没有HTTP 请求头和请求体，因为只需要一个请求行就可以完整表达客户端的需求了。")]),v._v(" "),e("li",[v._v("第二个是服务器也没有返回头信息，这是因为服务器端并不需要告诉客户端太多信息，只需要返回数据就可以了。")]),v._v(" "),e("li",[v._v("第三个是返回的文件内容是以 ASCII 字符流来传输的，因为都是 HTML 格式的文件，所以使用 ASCII 字节码来传输是最合适的。")])]),v._v(" "),e("h2",{attrs:{id:"http1-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http1-0"}},[v._v("#")]),v._v(" HTTP1.0")]),v._v(" "),e("p",[v._v("浏览器中展示的不单是 HTML 文件了，还包括了 JavaScript、CSS、图片、音频、视频等不同类型的文件。因此支持多种类型的文件下载是 HTTP/1.0 的一个核心诉求，而且文件格式不仅仅局限于 ASCII 编码，还有很多其他类型编码的文件.")]),v._v(" "),e("p",[v._v("为了让客户端和服务器能更深入地交流，HTTP/1.0 引入了请求头和响应头，它们都是以为 Key-Value 形式保存的，在 HTTP 发送请求时，会带上请求头信息，服务器返回数据时，会先返回响应头信息")]),v._v(" "),e("ul",[e("li",[v._v("实现多种类型文件的下载,根据请求头和响应头来判别。")]),v._v(" "),e("li",[v._v("有的请求服务器可能无法处理，或者处理出错，这时候就需要告诉浏览器服务器最终处理该请求的情况，这就引入了状态码。状态码是通过响应行的方式来通知浏览器的。")]),v._v(" "),e("li",[v._v("为了减轻服务器的压力，在 HTTP/1.0 中提供了Cache 机制，用来缓存已经下载过的数据。")]),v._v(" "),e("li",[v._v("服务器需要统计客户端的基础信息，比如 Windows 和 macOS 的用户数量分别是多少，所以 HTTP/1.0 的请求头中还加入了用户代理的字段")])]),v._v(" "),e("h2",{attrs:{id:"http1-1"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http1-1"}},[v._v("#")]),v._v(" HTTP1.1")]),v._v(" "),e("ul",[e("li",[e("p",[v._v("改进持久连接,默认使用connection：kepp-alive;")]),v._v(" "),e("ul",[e("li",[v._v("持久连接虽然能减少 TCP 的建立和断开次数，但是它需要等待前面的请求返回之后，才能进行下一次请求。如果 TCP 通道中的某个请求因为某些原因没有及时返回，那么就会阻塞后面的所有请求，这就是著名的队头阻塞的问题。")])])]),v._v(" "),e("li",[e("p",[v._v("不成熟的 HTTP 管线化: 指将多个 HTTP 请求整批提交给服务器的技术，虽然可以整批发送请求，不过服务器依然需要根据请求顺序来回复浏览器的请求。最终被抛弃。")])]),v._v(" "),e("li",[e("p",[v._v("提供虚拟主机的支持")])]),v._v(" "),e("li",[e("p",[v._v("在 HTTP/1.0 中，每个域名绑定了一个唯一的 IP 地址，因此一个服务器只能支持一个域名。但是随着虚拟主机技术的发展，需要实现在一台物理主机上绑定多个虚拟主机，每个虚拟主机都有自己的单独的域名，这些单独的域名都公用同一个 IP 地址。")]),v._v(" "),e("p",[v._v("因此，HTTP/1.1 的请求头中增加了Host 字段，用来表示当前的域名地址，这样服务器就可以根据不同的 Host 值做不同的处理。")])]),v._v(" "),e("li",[e("p",[v._v("对动态生成的内容提供了完美支持")]),v._v(" "),e("ul",[e("li",[v._v("在设计 HTTP/1.0 时，需要在响应头中设置完整的数据大小，如Content-Length: 901，这样浏览器就可以根据设置的数据大小来接收数据。不过随着服务器端的技术发展，很多页面的内容都是动态生成的，因此在传输数据之前并不知道最终的数据大小，这就导致了浏览器不知道何时会接收完所有的文件数据。")]),v._v(" "),e("li",[v._v("HTTP/1.1 通过引入Chunk transfer 机制来解决这个问题，服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，最后使用一个零长度的块作为发送数据完成的标志。这样就提供了对动态内容的支持。")])])]),v._v(" "),e("li",[e("p",[v._v("客户端 Cookie、安全机制")])])]),v._v(" "),e("p",[e("strong",[v._v("核心：")])]),v._v(" "),e("ul",[e("li",[v._v("增加了持久连接；")]),v._v(" "),e("li",[v._v("浏览器为每个域名最多同时维护 6 个 TCP 持久连接；")]),v._v(" "),e("li",[v._v("使用 CDN 的实现域名分片机制。")])]),v._v(" "),e("p",[e("strong",[v._v("存在的问题：")])]),v._v(" "),e("ul",[e("li",[v._v("第一个原因，TCP 的慢启动。")]),v._v(" "),e("li",[v._v("HTTP/1.1 队头阻塞的问题。")]),v._v(" "),e("li",[v._v("同时开启了多条 TCP 连接，那么这些连接会竞争固定的带宽")])])])}),[],!1,null,null,null);_.default=o.exports}}]);